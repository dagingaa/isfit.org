<h1 style="margin-bottom:0px">Internal Newsfeed</h1>  
(<%= link_to "Create article", :controller => "article", :action => "create" %>)
<div class="article">
<% for article in @articles %>
	<h3><%= link_to article.title, :action => "show", :id => article.id%></h3>
	<table width="100%"><tr><td valign="top">
		<span class="meta">
			<%= link_to LdapUser.get_by_id(article.user_id).firstname + " " +
				LdapUser.get_by_id(article.user_id).lastname, 
				:controller => "user", :action => "show", 
				:id => LdapUser.get_by_id(article.user_id).dn %>
			(<%= LdapUser.get_by_id(article.user_id).unit.description %>) for
			<%= LdapUnit.get_by_dn(article.group_dn).description %>		
			(<%=article.created_at.strftime("%d %b %Y %H:%M")%>)

			<% if current_user.id == article.user_id %>
	        <%= link_to(image_tag("icon/edit.png", :alt => "Edit",
					:title => "Edit", :border => 0),
					{
						:controller => "article", :action => "create",
						:id => article.id
					}) 
			%>
	        <%= link_to(image_tag("icon/trash.png", :alt => "Delete",
					:title => "Delete", :border => 0),
					{
						:controller => "article", :action => "delete",
						:id => article.id
					},
					:confirm => 'Are you sure you want to delete this article?')
	 		%>
			<% end %>
		</span><br />
	<%= format(truncate(article.body, 300, "...")) %>
	
	<%= article.body.length > 300 ? (link_to(
		"Read more...", :controller => "article", :action => "show", 
		:id => article.id)) : '' %>
	</td><td>
	<% if FileTest.exist?(
		"#{RAILS_ROOT}/public/images/article_images/#{article.id}.jpg")%>
		<%= link_to (image_tag("article_images/#{article.id}.jpg", :title=> "",
			:height => "100px", :style => "float: right",:border=>"0"), :action => "show", :id => article.id) %>
	<% end %>
	</td></tr></table>
<% end %>
<p>
	<span style="float: left"><%= will_paginate @articles %></span>
	&nbsp;
</p>
</div>
