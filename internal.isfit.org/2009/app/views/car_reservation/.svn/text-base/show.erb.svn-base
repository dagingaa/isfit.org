<h1>Car reservation</h1>
|
<%@daysforres.each do |day|%>
	<% if (day.strftime("%d-%m %Y") != @time.strftime("%d-%m %Y"))%>
		<%=link_to "#{day.strftime("%d-%m")}", :controller => "car_reservation", :action =>"show", :month => "#{day.strftime("%m")}", :day => "#{day.strftime("%d")}", :year => "#{day.strftime("%Y")}"%> | 
	<%else%>
		<%=day.strftime("%d-%m")%> |
	<%end%>

<%end%>
<br />
<br />
<h1><%=@time.strftime("%A %e %B %Y")%></h1>
<br />
<br />
<table border =1>

	<tr>
		<td></td>
		<%@cars.each do |car|%>
			<%if @transportmember%>
				<th width = 100><%=link_to "#{car.name}", {:controller=>"car_reservation", :action=>"details", :car=>car.id, :month => @time.strftime("%m"), :day => @time.strftime("%d")}, :style=> "color: blue" %></th>
			<%else%>
				<th width = 100><%=car.name%></th>
			<%end%>
		<%end%>
	</tr>
	<%(0).upto(23) do |time|%>
		<tr>
			<th>
				<%if time < 10%>
					0<%=time%>:00
				<%else%>
					<%=time%>:00
				<%end%>
				
			</th>
			<%@cars.each do |car|%>
				<%if ((@time.strftime("%d-%m") == @startdate.strftime("%d-%m")) && (time < @startdate.strftime("%H").to_i)) || ((@time.strftime("%d-%m") == @endate.strftime("%d-%m")) && (time > @endate.strftime("%H").to_i))%>
					<td align = "center" bgcolor="#cccccc">Not Available</td>
				<%elsif @reservation_matrix[time][car.id] == nil%>
					<td align = "center"><b><%=link_to "Reserve car", :controller => "car_reservation", :action =>"add", :car_id => car.id, :month => @time.strftime("%m"), :day => @time.strftime("%d"), :hour => time%></td>
				<%else%>
					<%if @transportmember%>
						<td align = "center" bgcolor="#cccccc"><%=link_to "#{LdapUnit.get_by_dn(@reservation_matrix[time][car.id].group_dn).description}", :controller => "car_reservation", :action =>"resdetails", :car_id => car.id, :month => @time.strftime("%m"), :day => @time.strftime("%d"), :hour => time%></td>
					<%else%>
						<td align = "center" bgcolor="#cccccc"><%=LdapUnit.get_by_dn(@reservation_matrix[time][car.id].group_dn).description%></td>
					<%end%>
				<%end%>
			<%end%>
		</tr>
	<%end%>
</table>

<%if @transportmember%>
	<h2><%=link_to "Details", :controller => "car_reservation", :action =>"details", :month => @time.strftime("%m"), :day => @time.strftime("%d")%></h2>
<%end%>